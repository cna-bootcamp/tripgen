<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>생성된일정조회 - TripGen</title>
  <link rel="stylesheet" href="assets/css/common.css">
  <style>
    /* 생성된 일정 조회 특화 스타일 */
    .itinerary-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: var(--space-6);
    }

    /* 일정 헤더 */
    .itinerary-header {
      background: var(--gray-50);
      border: 1px solid var(--gray-200);
      border-radius: 8px;
      padding: var(--space-3);
      margin-bottom: var(--space-6);
      text-align: center;
    }

    .trip-summary-text {
      font-size: var(--text-lg);
      font-weight: var(--font-semibold);
      color: var(--gray-800);
    }

    /* 액션 버튼들 */
    .itinerary-actions {
      display: flex;
      gap: var(--space-4);
      margin-bottom: var(--space-8);
      justify-content: center;
    }

    .itinerary-actions .btn {
      min-width: 120px;
      padding: var(--space-2) var(--space-4);
    }

    /* 날짜별 탭 네비게이션 */
    .day-tabs {
      display: flex;
      gap: var(--space-2);
      margin-bottom: var(--space-6);
      overflow-x: auto;
      padding-bottom: var(--space-2);
    }

    .day-tab {
      background: white;
      border: 2px solid var(--gray-200);
      border-radius: 12px;
      padding: var(--space-4) var(--space-6);
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
      min-width: 120px;
      text-align: center;
    }

    .day-tab:hover {
      border-color: var(--primary-blue);
      background: var(--gray-50);
    }

    .day-tab.active {
      background: var(--primary-blue);
      color: white;
      border-color: var(--primary-blue);
    }

    .day-tab .tab-date {
      font-size: var(--text-sm);
      font-weight: var(--font-medium);
      margin-bottom: var(--space-1);
    }

    .day-tab .tab-day {
      font-size: var(--text-lg);
      font-weight: var(--font-semibold);
    }

    .day-tab .regenerate-btn {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 6px;
      padding: var(--space-1) var(--space-2);
      font-size: var(--text-xs);
      color: white;
      cursor: pointer;
      margin-top: var(--space-2);
      transition: all 0.2s ease;
      display: none;
    }

    .day-tab.active .regenerate-btn {
      display: block;
    }

    .day-tab .regenerate-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .day-tab:not(.active) .regenerate-btn {
      background: var(--gray-100);
      border-color: var(--gray-300);
      color: var(--gray-600);
    }

    .day-tab:not(.active) .regenerate-btn:hover {
      background: var(--gray-200);
      border-color: var(--gray-400);
    }

    /* 일정 컨텐츠 */
    .day-content {
      display: none;
    }

    .day-content.active {
      display: block;
      animation: fadeIn 0.3s ease-in-out;
    }

    /* 타임라인 */
    .timeline {
      position: relative;
      padding-left: var(--space-8);
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: var(--space-4);
      top: 0;
      bottom: 0;
      width: 2px;
      background: var(--gray-300);
    }

    .timeline-item {
      position: relative;
      margin-bottom: var(--space-6);
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: calc(-1 * var(--space-4) - 6px);
      top: var(--space-4);
      width: 12px;
      height: 12px;
      background: var(--primary-blue);
      border-radius: 50%;
      border: 3px solid white;
      box-shadow: 0 0 0 2px var(--primary-blue);
    }

    .time-slot {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      transition: all 0.2s ease;
    }

    .time-slot:hover {
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      transform: translateY(-2px);
    }

    .time-header {
      background: var(--gray-50);
      padding: var(--space-4);
      border-bottom: 1px solid var(--gray-200);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .time-label {
      font-size: var(--text-lg);
      font-weight: var(--font-semibold);
      color: var(--primary-blue);
    }

    .time-period {
      font-size: var(--text-sm);
      color: var(--gray-600);
      background: white;
      padding: var(--space-1) var(--space-3);
      border-radius: 20px;
    }

    /* 장소 카드들 */
    .places-grid {
      padding: var(--space-6);
      display: grid;
      gap: var(--space-4);
    }

    .place-card {
      display: flex;
      gap: var(--space-4);
      align-items: center;
      padding: var(--space-4);
      border: 1px solid var(--gray-200);
      border-radius: 8px;
      transition: all 0.2s ease;
      cursor: pointer;
    }

    .place-card:hover {
      background: var(--gray-50);
      border-color: var(--primary-blue);
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .place-number {
      background: var(--primary-blue);
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: var(--font-semibold);
      font-size: var(--text-sm);
      flex-shrink: 0;
    }

    .place-info {
      flex: 1;
    }

    .place-name {
      font-size: var(--text-lg);
      font-weight: var(--font-semibold);
      margin-bottom: var(--space-1);
      color: var(--gray-800);
    }

    .place-address {
      font-size: var(--text-sm);
      color: var(--gray-600);
      margin-bottom: var(--space-2);
    }

    .place-details {
      display: flex;
      gap: var(--space-4);
      font-size: var(--text-sm);
      color: var(--gray-500);
    }

    .place-detail {
      display: flex;
      align-items: center;
      gap: var(--space-1);
    }

    .place-actions {
      display: flex;
      gap: var(--space-2);
      flex-shrink: 0;
    }

    .action-btn {
      background: none;
      border: 1px solid var(--gray-300);
      border-radius: 6px;
      padding: var(--space-2);
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--gray-600);
      min-width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .action-btn:hover {
      background: var(--primary-blue);
      color: white;
      border-color: var(--primary-blue);
    }

    .action-btn.map-btn:hover {
      background: var(--secondary-orange);
      border-color: var(--secondary-orange);
    }

    .action-btn.edit-btn:hover {
      background: var(--info);
      border-color: var(--info);
    }

    .action-btn.delete-btn:hover {
      background: var(--error);
      border-color: var(--error);
    }

    /* 이동 시간 표시 */
    .travel-time {
      text-align: center;
      padding: var(--space-3);
      margin: var(--space-2) 0;
      background: var(--gray-100);
      border-radius: 8px;
      font-size: var(--text-sm);
      color: var(--gray-600);
    }

    .travel-time .travel-icon {
      margin-right: var(--space-2);
    }

    /* 빈 상태 */
    .empty-state {
      text-align: center;
      padding: var(--space-12);
      color: var(--gray-500);
    }

    .empty-state .empty-icon {
      font-size: 4rem;
      margin-bottom: var(--space-4);
      opacity: 0.5;
    }

    /* 재생성 관련 스타일 */
    .regeneration-loading {
      text-align: center;
      padding: var(--space-12);
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border-radius: 16px;
      border: 2px dashed var(--primary-blue-light);
    }

    .regeneration-loading h3 {
      color: var(--primary-blue);
      margin-bottom: var(--space-4);
      font-size: var(--text-xl);
    }

    .regeneration-loading p {
      color: var(--gray-600);
      margin-bottom: var(--space-6);
    }

    .loading-progress {
      margin: var(--space-6) 0;
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background: var(--gray-200);
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: var(--space-3);
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-blue), var(--primary-blue-light));
      border-radius: 6px;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      font-size: var(--text-sm);
      color: var(--gray-600);
      font-weight: var(--font-medium);
    }

    .new-generated {
      border: 2px solid var(--success);
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(16, 185, 129, 0.1));
    }

    .new-indicator {
      background: var(--success);
      color: white;
      padding: var(--space-1) var(--space-2);
      border-radius: 12px;
      font-size: var(--text-xs);
      font-weight: var(--font-medium);
      margin-top: var(--space-3);
      display: inline-block;
    }

    /* 커스텀 다이얼로그 스타일 */
    .custom-dialog-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .custom-dialog-overlay.show {
      opacity: 1;
    }

    .custom-dialog {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 480px;
      width: 90%;
      max-height: 80vh;
      overflow: hidden;
      transform: scale(0.8) translateY(20px);
      transition: transform 0.3s ease;
    }

    .custom-dialog-overlay.show .custom-dialog {
      transform: scale(1) translateY(0);
    }

    .dialog-header {
      background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
      color: white;
      padding: var(--space-6);
      text-align: center;
    }

    .dialog-title {
      margin: 0;
      font-size: var(--text-xl);
      font-weight: var(--font-semibold);
    }

    .dialog-body {
      padding: var(--space-8);
      text-align: center;
    }

    .dialog-message {
      color: var(--gray-700);
      font-size: var(--text-base);
      line-height: 1.6;
      margin: 0;
    }

    .dialog-footer {
      padding: var(--space-6);
      display: flex;
      gap: var(--space-4);
      justify-content: center;
      border-top: 1px solid var(--gray-200);
    }

    .dialog-footer .btn {
      min-width: 100px;
      padding: var(--space-3) var(--space-6);
    }

    /* 커스텀 토스트 스타일 */
    .custom-toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
      border: 1px solid var(--gray-200);
      padding: var(--space-4);
      display: flex;
      align-items: center;
      justify-content: space-between;
      min-width: 320px;
      max-width: 480px;
      z-index: 10001;
      transform: translateX(100%);
      transition: transform 0.3s ease;
    }

    .custom-toast.show {
      transform: translateX(0);
    }

    .toast-content {
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .toast-icon {
      font-size: var(--text-lg);
      flex-shrink: 0;
    }

    .toast-message {
      color: var(--gray-800);
      font-size: var(--text-sm);
      font-weight: var(--font-medium);
    }

    .toast-close {
      background: none;
      border: none;
      color: var(--gray-500);
      font-size: var(--text-lg);
      cursor: pointer;
      padding: var(--space-1);
      border-radius: 4px;
      transition: background-color 0.2s ease;
      flex-shrink: 0;
    }

    .toast-close:hover {
      background: var(--gray-100);
      color: var(--gray-700);
    }

    /* 토스트 유형별 스타일 */
    .toast-success {
      border-left: 4px solid var(--success);
    }

    .toast-error {
      border-left: 4px solid var(--error);
    }

    .toast-warning {
      border-left: 4px solid var(--warning);
    }

    .toast-info {
      border-left: 4px solid var(--info);
    }

    /* 반응형 */
    @media (max-width: 767px) {
      .itinerary-container {
        padding: var(--space-4);
      }

      .itinerary-header {
        padding: var(--space-3);
      }

      .itinerary-actions {
        flex-direction: column;
        align-items: center;
      }

      .itinerary-actions .btn {
        width: 100%;
        max-width: 300px;
      }

      .day-tabs {
        justify-content: flex-start;
      }

      .timeline {
        padding-left: var(--space-6);
      }

      .place-card {
        flex-direction: column;
        align-items: flex-start;
      }

      .place-actions {
        align-self: stretch;
        justify-content: space-between;
      }

      .places-grid {
        padding: var(--space-4);
      }

      /* 모바일에서 토스트 위치 조정 */
      .custom-toast {
        top: 10px;
        right: 10px;
        left: 10px;
        min-width: auto;
        max-width: none;
      }

      /* 모바일에서 다이얼로그 조정 */
      .custom-dialog {
        margin: var(--space-4);
        max-width: none;
        width: calc(100% - var(--space-8));
      }

      .dialog-header {
        padding: var(--space-4);
      }

      .dialog-body {
        padding: var(--space-6);
      }

      .dialog-footer {
        padding: var(--space-4);
        flex-direction: column;
      }

      .dialog-footer .btn {
        width: 100%;
      }
    }

    @media (min-width: 768px) {
      .places-grid {
        grid-template-columns: 1fr;
      }
    }

    /* 모달 스타일 */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      padding: var(--space-6);
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-4);
      padding-bottom: var(--space-4);
      border-bottom: 1px solid var(--gray-200);
    }

    .modal-title {
      font-size: var(--text-xl);
      font-weight: var(--font-semibold);
      margin: 0;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: var(--text-2xl);
      cursor: pointer;
      color: var(--gray-500);
      padding: var(--space-2);
    }

    .modal-close:hover {
      color: var(--gray-800);
    }

    /* 상태 표시 */
    .status-badge {
      display: inline-block;
      padding: var(--space-1) var(--space-3);
      border-radius: 20px;
      font-size: var(--text-xs);
      font-weight: var(--font-medium);
      text-transform: uppercase;
    }

    .status-badge.verified {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
    }

    .status-badge.unverified {
      background: rgba(245, 158, 11, 0.1);
      color: var(--warning);
    }

    /* Navigation Progress Styles */
    .nav-progress-wrapper {
      background: #f9fafb;
      border-bottom: 1px solid #e5e7eb;
      padding: 16px 0;
    }

    .nav-progress-steps {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 24px;
      max-width: 600px;
      margin: 0 auto;
      flex-wrap: nowrap;
    }

    .nav-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      flex-shrink: 0;
      min-width: fit-content;
    }

    .nav-step--done {
      cursor: pointer;
    }

    .nav-step--done:hover {
      opacity: 0.8;
    }

    .nav-step__circle {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
      background: #d1d5db;
      color: #6b7280;
      transition: all 0.2s ease;
    }

    .nav-step--done .nav-step__circle {
      background: #10b981;
      color: white;
    }

    .nav-step--current .nav-step__circle {
      background: #2e86ab;
      color: white;
    }

    .nav-step__label {
      font-size: 12px;
      color: #6b7280;
      text-align: center;
      white-space: nowrap;
    }

    .nav-step--done .nav-step__label {
      color: #10b981;
    }

    .nav-step--current .nav-step__label {
      color: #2e86ab;
      font-weight: 600;
    }

    /* 다시 생성 모달 스타일 */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    
    .regenerate-modal {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--space-6);
      border-bottom: 1px solid var(--gray-200);
    }
    
    .modal-header h3 {
      margin: 0;
      font-size: var(--text-xl);
      font-weight: var(--font-semibold);
      color: var(--gray-800);
    }
    
    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      color: var(--gray-500);
      cursor: pointer;
      padding: var(--space-2);
      line-height: 1;
    }
    
    .modal-close:hover {
      color: var(--gray-700);
    }
    
    .modal-body {
      padding: var(--space-6);
    }
    
    .modal-description {
      color: var(--gray-600);
      margin-bottom: var(--space-6);
      line-height: 1.6;
    }
    
    .request-section {
      text-align: left;
    }
    
    .request-label {
      display: block;
      font-size: var(--text-base);
      font-weight: var(--font-medium);
      color: var(--gray-800);
      margin-bottom: var(--space-3);
    }
    
    .request-textarea {
      width: 100%;
      padding: var(--space-4);
      border: 2px solid var(--gray-300);
      border-radius: 12px;
      font-size: var(--text-base);
      font-family: inherit;
      resize: vertical;
      min-height: 80px;
      transition: all 0.3s ease;
      background: white;
      line-height: 1.5;
    }
    
    .request-textarea:focus {
      outline: none;
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgba(46, 134, 171, 0.1);
    }
    
    .request-textarea::placeholder {
      color: var(--gray-500);
      font-style: italic;
    }
    
    .char-count {
      text-align: right;
      font-size: var(--text-sm);
      color: var(--gray-500);
      margin-top: var(--space-2);
    }

    /* 시작시간 입력 스타일 */
    .start-time-section {
      margin: var(--space-6) 0 var(--space-6) 0;
      text-align: left;
      width: 100%;
    }

    .time-input-wrapper {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      max-width: 300px;
    }

    .time-input {
      width: 80px;
      padding: var(--space-3);
      border: 2px solid var(--gray-300);
      border-radius: 8px;
      font-size: var(--text-base);
      font-family: inherit;
      text-align: center;
      transition: all 0.3s ease;
      background: white;
    }

    .time-input:focus {
      outline: none;
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgba(46, 134, 171, 0.1);
    }

    .time-unit {
      font-size: var(--text-base);
      color: var(--gray-700);
      font-weight: var(--font-medium);
    }
    
    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: var(--space-3);
      padding: var(--space-6);
      border-top: 1px solid var(--gray-200);
    }
    
    @media (max-width: 768px) {
      .nav-progress-steps {
        gap: 16px;
        overflow-x: auto;
        padding: 0 8px;
      }
      
      .nav-step__label {
        font-size: 10px;
      }
      
      .nav-step__circle {
        width: 28px;
        height: 28px;
        font-size: 12px;
      }
      
      .regenerate-modal {
        width: 95%;
        margin: var(--space-4);
      }
      
      .modal-header, .modal-body, .modal-footer {
        padding: var(--space-4);
      }
    }
    
    /* 사용자 요청사항 표시 스타일 */
    .user-request-info {
      background: rgba(46, 134, 171, 0.1);
      border-left: 4px solid var(--primary-blue);
      padding: var(--space-3);
      margin: var(--space-4) 0;
      border-radius: 4px;
      font-size: var(--text-sm);
      color: var(--gray-700);
      font-style: italic;
    }

    /* 사용자 메뉴 스타일 */
    .user-menu {
        position: relative;
    }
    
    .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--primary-blue);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: var(--font-medium);
        cursor: pointer;
    }
    
    .notification-badge {
        position: absolute;
        top: -2px;
        right: -2px;
        width: 12px;
        height: 12px;
        background: var(--error);
        border-radius: 50%;
        border: 2px solid white;
    }
  </style>
</head>
<body>
  <header class="header">
    <nav class="nav container">
      <a href="01-대시보드.html" class="nav-brand">TripGen</a>
      <ul class="nav-menu">
        <li><a href="01-대시보드.html" class="nav-link">홈</a></li>
        <li><a href="02-기본설정.html" class="nav-link">새 여행 계획</a></li>
        <li><a href="javascript:showTravelListInfo()" class="nav-link">여행보기</a></li>
        <li><a href="09-주변장소검색.html" class="nav-link">주변장소 검색</a></li>
      </ul>
      
      <div class="nav-actions flex items-center gap-4">
        <button class="btn btn-secondary btn-sm" onclick="window.location.href='02-기본설정.html'">새 여행 시작</button>
        <div class="user-menu">
          <div class="user-avatar">
            김
            <span class="notification-badge"></span>
          </div>
        </div>
        <button class="mobile-menu-toggle">☰</button>
      </div>
    </nav>
  </header>

  <div class="mobile-overlay"></div>

  <main class="main">
    <!-- Navigation Progress -->
    <div class="nav-progress-wrapper">
      <div class="container">
        <div class="nav-progress-steps">
          <div class="nav-step nav-step--done" onclick="navigateToTripStep('02-기본설정.html')" style="cursor: pointer;">
            <div class="nav-step__circle">1</div>
            <span class="nav-step__label">기본설정</span>
          </div>
          <div class="nav-step nav-step--done" onclick="navigateToTripStep('03-여행일정설정.html')" style="cursor: pointer;">
            <div class="nav-step__circle">2</div>
            <span class="nav-step__label">일정설정</span>
          </div>
          <div class="nav-step nav-step--done" onclick="navigateToTripStep('05-AI일정생성.html')" style="cursor: pointer;">
            <div class="nav-step__circle">3</div>
            <span class="nav-step__label">AI일정생성</span>
          </div>
          <div class="nav-step nav-step--current">
            <div class="nav-step__circle">4</div>
            <span class="nav-step__label">일정조회</span>
          </div>
        </div>
      </div>
    </div>
    
    <div class="itinerary-container">
      <!-- 일정 헤더 -->
      <div class="itinerary-header">
        <div class="trip-summary-text">유럽가족여행(4명)</div>
      </div>

      <!-- 액션 버튼들 -->
      <div class="itinerary-actions">
        <button class="btn btn-primary" onclick="regenerateItinerary()">
          🔄 일정 재생성
        </button>
      </div>

      <!-- 날짜별 탭 -->
      <div class="day-tabs">
        <div class="day-tab active" data-day="1">
          <div class="tab-date">9월 1일 (일)</div>
          <div class="tab-day">1일차 뮌헨</div>
          <button class="regenerate-btn" onclick="regenerateDay(1)">🔄 다시 생성</button>
        </div>
        <div class="day-tab" data-day="2">
          <div class="tab-date">9월 2일 (월)</div>
          <div class="tab-day">2일차 뮌헨</div>
          <button class="regenerate-btn" onclick="regenerateDay(2)">🔄 다시 생성</button>
        </div>
        <div class="day-tab" data-day="3">
          <div class="tab-date">9월 3일 (화)</div>
          <div class="tab-day">3일차 잘츠부르크</div>
          <button class="regenerate-btn" onclick="regenerateDay(3)">🔄 다시 생성</button>
        </div>
        <div class="day-tab" data-day="4">
          <div class="tab-date">9월 4일 (수)</div>
          <div class="tab-day">4일차 잘츠부르크</div>
          <button class="regenerate-btn" onclick="regenerateDay(4)">🔄 다시 생성</button>
        </div>
        <div class="day-tab" data-day="5">
          <div class="tab-date">9월 5일 (목)</div>
          <div class="tab-day">5일차 잘츠부르크</div>
          <button class="regenerate-btn" onclick="regenerateDay(5)">🔄 다시 생성</button>
        </div>
        <div class="day-tab" data-day="6">
          <div class="tab-date">9월 6일 (금)</div>
          <div class="tab-day">6일차 돌로미티</div>
          <button class="regenerate-btn" onclick="regenerateDay(6)">🔄 다시 생성</button>
        </div>
        <div class="day-tab" data-day="7">
          <div class="tab-date">9월 7일 (토)</div>
          <div class="tab-day">7일차 돌로미티</div>
          <button class="regenerate-btn" onclick="regenerateDay(7)">🔄 다시 생성</button>
        </div>
        <div class="day-tab" data-day="8">
          <div class="tab-date">9월 8일 (일)</div>
          <div class="tab-day">8일차 돌로미티</div>
          <button class="regenerate-btn" onclick="regenerateDay(8)">🔄 다시 생성</button>
        </div>
        <div class="day-tab" data-day="9">
          <div class="tab-date">9월 9일 (월)</div>
          <div class="tab-day">9일차 돌로미티</div>
          <button class="regenerate-btn" onclick="regenerateDay(9)">🔄 다시 생성</button>
        </div>
        <div class="day-tab" data-day="10">
          <div class="tab-date">9월 10일 (화)</div>
          <div class="tab-day">10일차 돌로미티</div>
          <button class="regenerate-btn" onclick="regenerateDay(10)">🔄 다시 생성</button>
        </div>
      </div>

      <!-- 첫째 날 일정 -->
      <div class="day-content active" id="day-1">
        <div class="timeline">
          <!-- 오전 일정 -->
          <div class="timeline-item">
            <div class="time-slot">
              <div class="time-header">
                <div class="time-label">09:00 - 12:00</div>
                <div class="time-period">오전</div>
              </div>
              
              <div class="places-grid">
                <div class="place-card" onclick="window.location.href='07-장소상세정보.html'">
                  <div class="place-number">1</div>
                  <div class="place-info">
                    <div class="place-name">마리엔플라츠 시계탑</div>
                    <div class="place-address">Marienplatz 1, 80331 München, 독일</div>
                    <div class="place-details">
                      <div class="place-detail">
                        <span>⏱️</span>
                        <span>2시간</span>
                      </div>
                      <div class="place-detail">
                        <span>🏛️</span>
                        <span>역사적 광장</span>
                      </div>
                      <div class="place-detail">
                        <span class="status-badge verified">검증완료</span>
                      </div>
                    </div>
                  </div>
                  <div class="place-actions">
                    <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(1)" data-tooltip="삭제">
                      🗑️
                    </button>
                  </div>
                </div>

                <div class="travel-time">
                  <span class="travel-icon">🚗</span>
                  차량으로 10분 이동 (마리엔플라츠 → 뮌헨 레지덴츠)
                </div>

                <div class="place-card" onclick="window.location.href='07-장소상세정보.html'">
                  <div class="place-number">2</div>
                  <div class="place-info">
                    <div class="place-name">뮌헨 레지덴츠 궁전</div>
                    <div class="place-address">Residenzstraße 1, 80333 München, 독일</div>
                    <div class="place-details">
                      <div class="place-detail">
                        <span>⏱️</span>
                        <span>1시간 30분</span>
                      </div>
                      <div class="place-detail">
                        <span>🏰</span>
                        <span>왕궁/박물관</span>
                      </div>
                      <div class="place-detail">
                        <span class="status-badge verified">검증완료</span>
                      </div>
                    </div>
                  </div>
                  <div class="place-actions">
                    <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(2)" data-tooltip="삭제">
                      🗑️
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 점심 일정 -->
          <div class="timeline-item">
            <div class="time-slot">
              <div class="time-header">
                <div class="time-label">12:00 - 14:00</div>
                <div class="time-period">점심</div>
              </div>
              
              <div class="places-grid">
                <div class="place-card" onclick="window.location.href='07-장소상세정보.html'">
                  <div class="place-number">3</div>
                  <div class="place-info">
                    <div class="place-name">호프브로이하우스</div>
                    <div class="place-address">Platzl 9, 80331 München, 독일</div>
                    <div class="place-details">
                      <div class="place-detail">
                        <span>⏱️</span>
                        <span>1시간 30분</span>
                      </div>
                      <div class="place-detail">
                        <span>🍺</span>
                        <span>전통 맥주집</span>
                      </div>
                      <div class="place-detail">
                        <span class="status-badge verified">검증완료</span>
                      </div>
                    </div>
                  </div>
                  <div class="place-actions">
                    <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(3)" data-tooltip="삭제">
                      🗑️
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 오후 일정 -->
          <div class="timeline-item">
            <div class="time-slot">
              <div class="time-header">
                <div class="time-label">14:30 - 18:00</div>
                <div class="time-period">오후</div>
              </div>
              
              <div class="places-grid">
                <div class="place-card" onclick="window.location.href='07-장소상세정보.html'">
                  <div class="place-number">4</div>
                  <div class="place-info">
                    <div class="place-name">님펜부르크 궁전</div>
                    <div class="place-address">Schloß Nymphenburg 1, 80638 München, 독일</div>
                    <div class="place-details">
                      <div class="place-detail">
                        <span>⏱️</span>
                        <span>2시간</span>
                      </div>
                      <div class="place-detail">
                        <span>🏰</span>
                        <span>바로크 궁전</span>
                      </div>
                      <div class="place-detail">
                        <span class="status-badge verified">검증완료</span>
                      </div>
                    </div>
                  </div>
                  <div class="place-actions">
                    <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(4)" data-tooltip="삭제">
                      🗑️
                    </button>
                  </div>
                </div>

                <div class="travel-time">
                  <span class="travel-icon">🚗</span>
                  차량으로 20분 이동 (님펜부르크 → 잉글리셔 가르텐)
                </div>

                <div class="place-card" onclick="window.location.href='07-장소상세정보.html'">
                  <div class="place-number">5</div>
                  <div class="place-info">
                    <div class="place-name">잉글리셔 가르텐</div>
                    <div class="place-address">Englischer Garten, 80538 München, 독일</div>
                    <div class="place-details">
                      <div class="place-detail">
                        <span>⏱️</span>
                        <span>1시간 30분</span>
                      </div>
                      <div class="place-detail">
                        <span>🌳</span>
                        <span>도시공원</span>
                      </div>
                      <div class="place-detail">
                        <span class="status-badge verified">검증완료</span>
                      </div>
                    </div>
                  </div>
                  <div class="place-actions">
                    <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(5)" data-tooltip="삭제">
                      🗑️
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 저녁 일정 -->
          <div class="timeline-item">
            <div class="time-slot">
              <div class="time-header">
                <div class="time-label">18:30 - 21:00</div>
                <div class="time-period">저녁</div>
              </div>
              
              <div class="places-grid">
                <div class="place-card" onclick="window.location.href='07-장소상세정보.html'">
                  <div class="place-number">6</div>
                  <div class="place-info">
                    <div class="place-name">라텐하우스</div>
                    <div class="place-address">Münzstraße 8, 80331 München, 독일</div>
                    <div class="place-details">
                      <div class="place-detail">
                        <span>⏱️</span>
                        <span>2시간</span>
                      </div>
                      <div class="place-detail">
                        <span>🥨</span>
                        <span>바이에른 전통요리</span>
                      </div>
                      <div class="place-detail">
                        <span class="status-badge verified">검증완료</span>
                      </div>
                    </div>
                  </div>
                  <div class="place-actions">
                    <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(6)" data-tooltip="삭제">
                      🗑️
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 둘째 날 일정 -->
      <div class="day-content" id="day-2">
        <div class="timeline">
          <div class="timeline-item">
            <div class="time-slot">
              <div class="time-header">
                <div class="time-label">09:00 - 12:00</div>
                <div class="time-period">오전</div>
              </div>
              
              <div class="places-grid">
                <div class="place-card" onclick="window.location.href='07-장소상세정보.html'">
                  <div class="place-number">1</div>
                  <div class="place-info">
                    <div class="place-name">츠키지 시장</div>
                    <div class="place-address">도쿄도 츄오구 츠키지 5-2-1</div>
                    <div class="place-details">
                      <div class="place-detail">
                        <span>⏱️</span>
                        <span>2시간</span>
                      </div>
                      <div class="place-detail">
                        <span>🐟</span>
                        <span>시장/음식</span>
                      </div>
                      <div class="place-detail">
                        <span class="status-badge verified">검증완료</span>
                      </div>
                    </div>
                  </div>
                  <div class="place-actions">
                    <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(7)" data-tooltip="삭제">
                      🗑️
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 셋째 날 일정 -->
      <div class="day-content" id="day-3">
        <div class="timeline">
          <div class="timeline-item">
            <div class="time-slot">
              <div class="time-header">
                <div class="time-label">09:00 - 12:00</div>
                <div class="time-period">오전</div>
              </div>
              
              <div class="places-grid">
                <div class="place-card" onclick="window.location.href='07-장소상세정보.html'">
                  <div class="place-number">1</div>
                  <div class="place-info">
                    <div class="place-name">도쿄역 & 쇼핑</div>
                    <div class="place-address">도쿄도 치요다구 마루노우치 1-9-1</div>
                    <div class="place-details">
                      <div class="place-detail">
                        <span>⏱️</span>
                        <span>3시간</span>
                      </div>
                      <div class="place-detail">
                        <span>🛍️</span>
                        <span>쇼핑/기념품</span>
                      </div>
                      <div class="place-detail">
                        <span class="status-badge verified">검증완료</span>
                      </div>
                    </div>
                  </div>
                  <div class="place-actions">
                    <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(8)" data-tooltip="삭제">
                      🗑️
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </main>

  <!-- 다시 생성 요청사항 모달 -->
  <div id="regenerateModal" class="modal-overlay" style="display: none;">
    <div class="modal-content regenerate-modal">
      <div class="modal-header">
        <h3 id="regenerateModalTitle">일정 다시 생성</h3>
        <button class="modal-close" onclick="closeRegenerateModal()">&times;</button>
      </div>
      
      <div class="modal-body">
        <p class="modal-description">
          해당 날짜 일정을 AI가 새로 생성합니다. 기존 일정은 새로운 일정으로 대체됩니다.
        </p>
        
        <!-- 시작시간 입력 -->
        <div class="start-time-section">
          <div class="time-input-wrapper">
            <label for="dayStartTime" class="request-label">
              여행 시작시간
            </label>
            <input 
              type="number" 
              id="dayStartTime" 
              class="time-input"
              placeholder="09"
              min="0"
              max="23"
              value="9">
            <span class="time-unit">시</span>
          </div>
        </div>

        <!-- 요청사항 입력 -->
        <div class="request-section">
          <label for="dayRegenerateRequest" class="request-label">
            특별한 요청사항이 있나요? (선택사항)
          </label>
          <textarea 
            id="dayRegenerateRequest" 
            class="request-textarea"
            placeholder="예: 맛집 위주로 구성해주세요. 대중교통으로 쉽게 이동할 수 있는 곳들로 부탁드립니다."
            maxlength="300"
            rows="3">
          </textarea>
          <div class="char-count">
            <span id="dayCharCount">0</span>/300자
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeRegenerateModal()">취소</button>
        <button class="btn btn-primary" onclick="confirmRegenerate()">다시 생성</button>
      </div>
    </div>
  </div>

  <!-- 장소 상세 정보 모달 -->
  <div class="modal" id="placeDetailModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">장소 상세 정보</h3>
        <button class="modal-close" onclick="TripGen.closeModal('placeDetailModal')">&times;</button>
      </div>
      <div class="modal-body">
        <div id="placeDetailContent">
          <!-- 동적으로 채워질 내용 -->
        </div>
      </div>
    </div>
  </div>

  <!-- 일정 수정 모달 -->
  <div class="modal" id="editItineraryModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">일정 수정</h3>
        <button class="modal-close" onclick="TripGen.closeModal('editItineraryModal')">&times;</button>
      </div>
      <div class="modal-body">
        <p>일정 수정 기능이 곧 제공됩니다.</p>
        <p>현재는 개별 장소의 수정만 가능합니다.</p>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 TripGen. 모든 권리 보유.</p>
    </div>
  </footer>

  <script src="assets/js/common.js"></script>
  <script>
    // 날짜별 탭 전환 기능
    function initDayTabs() {
      const tabs = document.querySelectorAll('.day-tab');
      const contents = document.querySelectorAll('.day-content');

      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const dayNumber = tab.getAttribute('data-day');
          
          // 모든 탭과 컨텐츠 비활성화
          tabs.forEach(t => t.classList.remove('active'));
          contents.forEach(c => c.classList.remove('active'));
          
          // 선택된 탭과 컨텐츠 활성화
          tab.classList.add('active');
          document.getElementById(`day-${dayNumber}`).classList.add('active');
        });
      });
    }

    // 일정 관련 기능들
    function regenerateItinerary() {
      // 바로 AI일정생성 페이지로 이동
      window.location.href = '05-AI일정생성.html';
    }

    function editItinerary() {
      TripGen.openModal('editItineraryModal');
    }

    function saveItinerary() {
      // 저장 로직
      TripGen.showToast('일정이 저장되었습니다.', 'success');
    }

    function shareItinerary() {
      // 공유 기능
      if (navigator.share) {
        navigator.share({
          title: '도쿄 3일 2박 여행 일정',
          text: 'AI가 생성한 맞춤형 여행 일정을 확인해보세요!',
          url: window.location.href
        });
      } else {
        // 폴백: URL 복사
        navigator.clipboard.writeText(window.location.href).then(() => {
          TripGen.showToast('링크가 클립보드에 복사되었습니다.', 'success');
        });
      }
    }

    // 장소 관련 기능들
    function showMap(placeId) {
      // 지도 보기 (임시)
      TripGen.showToast('지도 기능이 곧 제공됩니다.', 'info');
    }

    function editPlace(placeId) {
      // 장소 상세 정보 표시
      const placeDetails = {
        1: {
          name: '센소지 (浅草寺)',
          address: '도쿄도 다이토구 아사쿠사 2-3-1',
          description: '도쿄에서 가장 오래된 사원으로, 628년에 창건되었습니다. 전통적인 일본 문화를 체험할 수 있는 대표적인 관광지입니다.',
          openHours: '06:00 - 17:00',
          phone: '+81-3-3842-0181',
          website: 'https://www.senso-ji.jp/',
          rating: 4.5,
          price: '무료',
          tips: '이른 아침에 방문하면 상대적으로 한적합니다. 주변 나카미세도리에서 기념품 쇼핑도 가능합니다.'
        }
        // 다른 장소들도 추가 가능
      };

      const place = placeDetails[placeId];
      if (place) {
        document.getElementById('placeDetailContent').innerHTML = `
          <div class="place-detail-info">
            <h4>${place.name}</h4>
            <p><strong>주소:</strong> ${place.address}</p>
            <p><strong>설명:</strong> ${place.description}</p>
            <p><strong>운영시간:</strong> ${place.openHours}</p>
            <p><strong>전화번호:</strong> ${place.phone}</p>
            <p><strong>웹사이트:</strong> <a href="${place.website}" target="_blank">${place.website}</a></p>
            <p><strong>평점:</strong> ⭐ ${place.rating}/5.0</p>
            <p><strong>입장료:</strong> ${place.price}</p>
            <p><strong>팁:</strong> ${place.tips}</p>
          </div>
        `;
        TripGen.openModal('placeDetailModal');
      }
    }

    function deletePlace(placeId) {
      TripGen.confirmDialog('이 장소를 일정에서 삭제하시겠습니까?', () => {
        // 삭제 로직 (실제로는 서버 통신)
        TripGen.showToast('장소가 삭제되었습니다.', 'success');
        // DOM에서 해당 장소 카드 제거하는 로직 추가 가능
      });
    }

    // 날짜별 일정 다시 생성 기능
    function regenerateDay(dayNumber) {
      // 이벤트 버블링 방지
      event.stopPropagation();
      
      const dayNames = {
        1: '첫째 날',
        2: '둘째 날', 
        3: '셋째 날'
      };
      
      const dayName = dayNames[dayNumber] || `${dayNumber}번째 날`;
      
      // 모달 제목 업데이트
      document.getElementById('regenerateModalTitle').textContent = `${dayName} 일정 다시 생성`;
      
      // 기존 요청사항과 시작시간 불러오기 (있다면)
      const savedRequest = localStorage.getItem(`dayRequest_${dayNumber}`) || '';
      const savedStartTime = localStorage.getItem(`dayStartTime_${dayNumber}`) || '9';
      
      const textarea = document.getElementById('dayRegenerateRequest');
      const charCount = document.getElementById('dayCharCount');
      const startTimeInput = document.getElementById('dayStartTime');
      
      textarea.value = savedRequest;
      charCount.textContent = savedRequest.length;
      startTimeInput.value = savedStartTime;
      
      // 모달 표시
      document.getElementById('regenerateModal').style.display = 'flex';
      
      // 현재 날짜 저장
      window.currentRegenerateDay = dayNumber;
    }

    // 모달 닫기
    function closeRegenerateModal() {
      document.getElementById('regenerateModal').style.display = 'none';
      window.currentRegenerateDay = null;
    }
    
    // 다시 생성 확정
    function confirmRegenerate() {
      const dayNumber = window.currentRegenerateDay;
      if (dayNumber === null) return;
      
      const textarea = document.getElementById('dayRegenerateRequest');
      const startTimeInput = document.getElementById('dayStartTime');
      const userRequest = textarea.value.trim();
      const startTime = startTimeInput.value;
      
      // 요청사항과 시작시간 저장
      if (userRequest) {
        localStorage.setItem(`dayRequest_${dayNumber}`, userRequest);
        console.log(`${dayNumber}일차 요청사항:`, userRequest);
      }
      localStorage.setItem(`dayStartTime_${dayNumber}`, startTime);
      console.log(`${dayNumber}일차 시작시간:`, startTime + '시');
      
      // 모달 닫기
      closeRegenerateModal();
      
      // 실제 재생성 실행
      regenerateDayItinerary(dayNumber, userRequest);
    }
    
    function regenerateDayItinerary(dayNumber, userRequest = '') {
      const dayContent = document.getElementById(`day-${dayNumber}`);
      const originalContent = dayContent.innerHTML;
      
      try {
        // 사용자 요청사항 표시
        const requestInfo = userRequest ? `<p class="user-request-info">특별 요청: ${userRequest}</p>` : '';
        
        // 로딩 상태로 변경
        dayContent.innerHTML = `
          <div class="regeneration-loading">
            <div class="loading-spinner"></div>
            <h3>AI가 ${dayNumber}일차 일정을 새로 생성하고 있습니다...</h3>
            <p>기존 여행 정보를 바탕으로 더 나은 일정을 만들어드릴게요.</p>
            ${requestInfo}
            <div class="loading-progress">
              <div class="progress-bar">
                <div class="progress-fill" id="regenerateProgress"></div>
              </div>
              <div class="progress-text" id="progressText">장소 분석 중...</div>
            </div>
            <button class="btn btn-secondary btn-sm" onclick="cancelRegeneration(${dayNumber}, \`${originalContent.replace(/`/g, '\\`')}\`)">
              취소
            </button>
          </div>
        `;

        // 진행률 시뮬레이션
        simulateRegenerationProgress(dayNumber, originalContent);
        
      } catch (error) {
        console.error('일정 재생성 중 오류:', error);
        showCustomToast('일정 재생성 중 오류가 발생했습니다.', 'error');
        dayContent.innerHTML = originalContent;
      }
    }

    function simulateRegenerationProgress(dayNumber, originalContent) {
      const progressFill = document.getElementById('regenerateProgress');
      const progressText = document.getElementById('progressText');
      
      if (!progressFill || !progressText) return;
      
      const steps = [
        { progress: 20, text: '기존 일정 분석 중...' },
        { progress: 40, text: '새로운 장소 검색 중...' },
        { progress: 60, text: '이동 경로 최적화 중...' },
        { progress: 80, text: '일정 조정 중...' },
        { progress: 100, text: '새로운 일정 생성 완료!' }
      ];
      
      let currentStep = 0;
      
      const progressInterval = setInterval(() => {
        if (currentStep < steps.length) {
          const step = steps[currentStep];
          progressFill.style.width = step.progress + '%';
          progressText.textContent = step.text;
          currentStep++;
        } else {
          clearInterval(progressInterval);
          // 재생성 완료
          setTimeout(() => {
            completeRegeneration(dayNumber);
          }, 1000);
        }
      }, 800);
    }

    function completeRegeneration(dayNumber) {
      const dayContent = document.getElementById(`day-${dayNumber}`);
      
      // 새로운 일정 데이터 (시뮬레이션)
      const newItineraries = {
        1: generateNewDayItinerary('첫째 날', [
          { time: '09:00', name: '우에노 공원', type: '관광', duration: '2시간', move: '15분' },
          { time: '11:30', name: '도쿄국립박물관', type: '문화', duration: '2시간', move: '10분' },
          { time: '14:00', name: '아메요코 시장', type: '쇼핑', duration: '1.5시간', move: '20분' },
          { time: '16:30', name: '센소지 절', type: '관광', duration: '1.5시간', move: '25분' },
          { time: '19:00', name: '스카이트리 타운', type: '관광', duration: '2시간', move: '0분' }
        ]),
        2: generateNewDayItinerary('둘째 날', [
          { time: '10:00', name: '메이지 신궁', type: '문화', duration: '1.5시간', move: '10분' },
          { time: '12:00', name: '하라주쿠 거리', type: '쇼핑', duration: '2시간', move: '15분' },
          { time: '15:00', name: '시부야 스카이', type: '관광', duration: '1시간', move: '5분' },
          { time: '17:00', name: '시부야 크로싱', type: '관광', duration: '1시간', move: '10분' },
          { time: '19:00', name: '롯폰기 힐즈', type: '관광', duration: '2시간', move: '0분' }
        ]),
        3: generateNewDayItinerary('셋째 날', [
          { time: '09:30', name: '츠키지 장외시장', type: '음식', duration: '2시간', move: '20분' },
          { time: '12:30', name: '황궁 동쪽 정원', type: '관광', duration: '1.5시간', move: '15분' },
          { time: '15:00', name: '긴자 거리', type: '쇼핑', duration: '2시간', move: '10분' },
          { time: '18:00', name: '도쿄역 주변', type: '음식', duration: '1.5시간', move: '0분' }
        ])
      };
      
      dayContent.innerHTML = newItineraries[dayNumber] || originalContent;
      
      showCustomToast(`${dayNumber}일차 일정이 새롭게 생성되었습니다!`, 'success', 4000);
    }

    function generateNewDayItinerary(dayName, places) {
      // 시간대별로 그룹 나누기
      const morningPlaces = places.slice(0, Math.ceil(places.length / 2));
      const afternoonPlaces = places.slice(Math.ceil(places.length / 2));
      
      let html = '<div class="timeline">';
      
      // 오전 일정
      if (morningPlaces.length > 0) {
        html += `
          <div class="timeline-item">
            <div class="time-slot">
              <div class="time-header">
                <div class="time-label">09:00 - 12:00</div>
                <div class="time-period">오전</div>
              </div>
              
              <div class="places-grid">
                ${morningPlaces.map((place, index) => `
                  <div class="place-card new-generated" onclick="window.location.href='07-장소상세정보.html'">
                    <div class="place-number">${index + 1}</div>
                    <div class="place-info">
                      <div class="place-name">${place.name}</div>
                      <div class="place-address">${getPlaceAddress(place.name)}</div>
                      <div class="place-details">
                        <div class="place-detail">
                          <span>⏱️</span>
                          <span>${place.duration}</span>
                        </div>
                        <div class="place-detail">
                          <span>${getTypeIcon(place.type)}</span>
                          <span>${getCategoryName(place.type)}</span>
                        </div>
                        <div class="place-detail">
                          <span class="status-badge verified">검증완료</span>
                        </div>
                      </div>
                    </div>
                    <div class="place-actions">
                      <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(${index + 1})" data-tooltip="삭제">
                        🗑️
                      </button>
                    </div>
                    <div class="new-indicator">🆕 새로 생성된 일정</div>
                  </div>
                  
                  ${index < morningPlaces.length - 1 ? `
                    <div class="travel-time">
                      <span class="travel-icon">🚇</span>
                      ${getMoveMethod(place.type)}로 ${place.move} 이동 (${getRandomDistance()})
                    </div>
                  ` : ''}
                `).join('')}
              </div>
            </div>
          </div>
        `;
      }
      
      // 오후 일정
      if (afternoonPlaces.length > 0) {
        html += `
          <div class="timeline-item">
            <div class="time-slot">
              <div class="time-header">
                <div class="time-label">13:00 - 18:00</div>
                <div class="time-period">오후</div>
              </div>
              
              <div class="places-grid">
                ${afternoonPlaces.map((place, index) => `
                  <div class="place-card new-generated" onclick="window.location.href='07-장소상세정보.html'">
                    <div class="place-number">${morningPlaces.length + index + 1}</div>
                    <div class="place-info">
                      <div class="place-name">${place.name}</div>
                      <div class="place-address">${getPlaceAddress(place.name)}</div>
                      <div class="place-details">
                        <div class="place-detail">
                          <span>⏱️</span>
                          <span>${place.duration}</span>
                        </div>
                        <div class="place-detail">
                          <span>${getTypeIcon(place.type)}</span>
                          <span>${getCategoryName(place.type)}</span>
                        </div>
                        <div class="place-detail">
                          <span class="status-badge verified">검증완료</span>
                        </div>
                      </div>
                    </div>
                    <div class="place-actions">
                      <button class="action-btn delete-btn" onclick="event.stopPropagation(); deletePlace(${morningPlaces.length + index + 1})" data-tooltip="삭제">
                        🗑️
                      </button>
                    </div>
                    <div class="new-indicator">🆕 새로 생성된 일정</div>
                  </div>
                  
                  ${index < afternoonPlaces.length - 1 ? `
                    <div class="travel-time">
                      <span class="travel-icon">🚇</span>
                      ${getMoveMethod(place.type)}로 ${place.move} 이동 (${getRandomDistance()})
                    </div>
                  ` : ''}
                `).join('')}
              </div>
            </div>
          </div>
        `;
      }
      
      html += '</div>';
      return html;
    }

    function getTypeIcon(type) {
      const icons = {
        '관광': '🏛️',
        '문화': '🎭', 
        '쇼핑': '🛍️',
        '음식': '🍽️'
      };
      return icons[type] || '📍';
    }

    function getTypeName(type) {
      const names = {
        '관광': '관광지',
        '문화': '문화체험',
        '쇼핑': '쇼핑',
        '음식': '맛집'
      };
      return names[type] || '장소';
    }

    function cancelRegeneration(dayNumber, originalContent) {
      const dayContent = document.getElementById(`day-${dayNumber}`);
      dayContent.innerHTML = originalContent;
      showCustomToast('일정 재생성이 취소되었습니다.', 'info');
    }

    // 장소 정보를 위한 헬퍼 함수들
    function getPlaceAddress(placeName) {
      const addresses = {
        '우에노 공원': '도쿄도 다이토구 우에노코엔',
        '도쿄국립박물관': '도쿄도 다이토구 우에노코엔 13-9',
        '아메요코 시장': '도쿄도 다이토구 우에노 4-10-10',
        '센소지 절': '도쿄도 다이토구 아사쿠사 2-3-1',
        '스카이트리 타운': '도쿄도 스미다구 오시아게 1-1-2',
        '메이지 신궁': '도쿄도 시부야구 시부야 1-1',
        '하라주쿠 거리': '도쿄도 시부야구 진구마에 1-19-9',
        '시부야 스카이': '도쿄도 시부야구 시부야 2-24-12',
        '시부야 크로싱': '도쿄도 시부야구 도겐자카 1-1',
        '롯폰기 힐즈': '도쿄도 미나토구 롯폰기 6-10-1',
        '츠키지 장외시장': '도쿄도 츄오구 츠키지 4-16-2',
        '황궁 동쪽 정원': '도쿄도 치요다구 코쿄가이엔 1-1',
        '긴자 거리': '도쿄도 츄오구 긴자 4-6-16',
        '도쿄역 주변': '도쿄도 치요다구 마루노우치 1-9-1'
      };
      return addresses[placeName] || '도쿄도 내 위치';
    }

    function getCategoryClass(type) {
      const classes = {
        '관광': 'tourism',
        '문화': 'culture',
        '쇼핑': 'shopping',
        '음식': 'restaurant'
      };
      return classes[type] || 'tourism';
    }

    function getCategoryName(type) {
      const names = {
        '관광': '관광지',
        '문화': '문화체험',
        '쇼핑': '쇼핑',
        '음식': '맛집'
      };
      return names[type] || '장소';
    }

    function getRandomRating() {
      const ratings = ['4.2', '4.3', '4.4', '4.5', '4.6', '4.7', '4.8'];
      return ratings[Math.floor(Math.random() * ratings.length)];
    }

    function getMoveIcon(type) {
      return '🚇'; // 지하철 아이콘 통일
    }

    function getMoveMethod(type) {
      return '지하철'; // 이동수단 통일
    }

    function getRandomDistance() {
      const distances = ['0.8km', '1.2km', '1.5km', '2.1km', '2.8km'];
      return distances[Math.floor(Math.random() * distances.length)];
    }

    // 커스텀 확인 다이얼로그 함수
    function showCustomConfirmDialog(title, message, onConfirm) {
      // 기존 다이얼로그가 있으면 제거
      const existingDialog = document.getElementById('customConfirmDialog');
      if (existingDialog) {
        existingDialog.remove();
      }

      // 다이얼로그 HTML 생성
      const dialogHTML = `
        <div id="customConfirmDialog" class="custom-dialog-overlay">
          <div class="custom-dialog">
            <div class="dialog-header">
              <h3 class="dialog-title">${title}</h3>
            </div>
            <div class="dialog-body">
              <p class="dialog-message">${message.replace(/\n/g, '<br>')}</p>
            </div>
            <div class="dialog-footer">
              <button class="btn btn-secondary" onclick="closeCustomDialog()">취소</button>
              <button class="btn btn-primary" onclick="confirmCustomDialog()">확인</button>
            </div>
          </div>
        </div>
      `;

      // 다이얼로그를 body에 추가
      document.body.insertAdjacentHTML('beforeend', dialogHTML);
      
      // 확인 콜백 저장
      window.customDialogCallback = onConfirm;
      
      // 애니메이션 효과
      setTimeout(() => {
        document.getElementById('customConfirmDialog').classList.add('show');
      }, 10);
    }

    function closeCustomDialog() {
      const dialog = document.getElementById('customConfirmDialog');
      if (dialog) {
        dialog.classList.remove('show');
        setTimeout(() => {
          dialog.remove();
        }, 300);
      }
      window.customDialogCallback = null;
    }

    function confirmCustomDialog() {
      if (window.customDialogCallback) {
        window.customDialogCallback();
      }
      closeCustomDialog();
    }

    // 커스텀 토스트 함수
    function showCustomToast(message, type = 'info', duration = 3000) {
      // 기존 토스트 제거
      const existingToast = document.getElementById('customToast');
      if (existingToast) {
        existingToast.remove();
      }

      const icons = {
        success: '✅',
        error: '❌', 
        warning: '⚠️',
        info: 'ℹ️'
      };

      const toastHTML = `
        <div id="customToast" class="custom-toast toast-${type}">
          <div class="toast-content">
            <span class="toast-icon">${icons[type] || icons.info}</span>
            <span class="toast-message">${message}</span>
          </div>
          <button class="toast-close" onclick="closeCustomToast()">×</button>
        </div>
      `;

      document.body.insertAdjacentHTML('beforeend', toastHTML);
      
      // 애니메이션 효과
      setTimeout(() => {
        document.getElementById('customToast').classList.add('show');
      }, 10);

      // 자동 제거
      setTimeout(() => {
        closeCustomToast();
      }, duration);
    }

    function closeCustomToast() {
      const toast = document.getElementById('customToast');
      if (toast) {
        toast.classList.remove('show');
        setTimeout(() => {
          toast.remove();
        }, 300);
      }
    }

    // 여행 정보 로드 함수
    function loadTripInfo() {
      // 기본설정에서 저장된 정보 가져오기
      let tripName = '여행 계획';
      let dateRange = '';
      
      try {
        // 기본설정 데이터 읽기
        const basicSettingsData = localStorage.getItem('basicSettingsData');
        if (basicSettingsData) {
          const data = JSON.parse(basicSettingsData);
          if (data.tripName && data.tripName.trim()) {
            tripName = data.tripName.trim();
            console.log('여행명 로드됨:', tripName);
          } else {
            console.warn('기본설정에서 여행명을 찾을 수 없습니다.');
          }
        } else {
          console.warn('기본설정 데이터가 없습니다.');
        }
        
        // 여행일정 데이터 읽기
        const tripScheduleData = localStorage.getItem('tripScheduleData');
        if (tripScheduleData) {
          const scheduleData = JSON.parse(tripScheduleData);
          // 첫 번째 여행 계획의 날짜 사용
          if (scheduleData.startDate_1 && scheduleData.endDate_1) {
            const startDate = new Date(scheduleData.startDate_1);
            const endDate = new Date(scheduleData.endDate_1);
            
            const startDateStr = startDate.toLocaleDateString('ko-KR', {
              month: 'long',
              day: 'numeric'
            });
            const endDateStr = endDate.toLocaleDateString('ko-KR', {
              month: 'long', 
              day: 'numeric'
            });
            
            dateRange = `(${startDateStr} ~ ${endDateStr})`;
          }
        }
      } catch (error) {
        console.warn('여행 데이터 로드 실패:', error);
      }
      
      // 여행명(시작일 ~ 종료일) 형식으로 업데이트
      const summaryText = document.querySelector('.trip-summary-text');
      if (summaryText) {
        summaryText.textContent = `${tripName}${dateRange}`;
      }
    }
    
    // 다시 생성 모달 초기화
    function initRegenerateModal() {
      const textarea = document.getElementById('dayRegenerateRequest');
      const charCount = document.getElementById('dayCharCount');
      
      if (textarea && charCount) {
        // 글자 수 카운터
        textarea.addEventListener('input', () => {
          const count = textarea.value.length;
          charCount.textContent = count;
          
          // 250자 이상이면 경고 색상
          if (count >= 250) {
            charCount.style.color = 'var(--error)';
          } else if (count >= 200) {
            charCount.style.color = 'var(--warning)';
          } else {
            charCount.style.color = 'var(--gray-500)';
          }
        });
        
        // 입력 시 자동 저장
        textarea.addEventListener('input', () => {
          if (window.currentRegenerateDay) {
            localStorage.setItem(`dayRequest_${window.currentRegenerateDay}`, textarea.value);
          }
        });
      }

      // 시작시간 입력 처리
      const startTimeInput = document.getElementById('dayStartTime');
      if (startTimeInput) {
        // 시간 유효성 검사
        startTimeInput.addEventListener('blur', () => {
          let value = parseInt(startTimeInput.value);
          if (isNaN(value) || value < 0) {
            value = 9;
          } else if (value > 23) {
            value = 23;
          }
          startTimeInput.value = value;
        });
      }
      
      // 모달 외부 클릭 시 닫기
      const modal = document.getElementById('regenerateModal');
      if (modal) {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            closeRegenerateModal();
          }
        });
      }
    }

    // 현재 여행 정보 (여행중 상태만 접근 가능)
    const currentTrip = {
        id: 'europe-family-trip',
        name: '유럽가족여행',
        status: 'in-progress'  // 항상 여행중 상태
    };

    // 페이지 로드 시 초기화
    document.addEventListener('DOMContentLoaded', function() {
      loadTripInfo();
      initDayTabs();
      initRegenerateModal();
      
      // 페이지 로드 애니메이션
      setTimeout(() => {
        document.querySelectorAll('.timeline-item').forEach((item, index) => {
          setTimeout(() => {
            item.classList.add('fade-in');
          }, index * 100);
        });
      }, 300);
    });

    // 드래그 앤 드롭 기능 (간단한 구현)
    let draggedElement = null;

    document.querySelectorAll('.place-card').forEach(card => {
      card.setAttribute('draggable', true);
      
      card.addEventListener('dragstart', (e) => {
        draggedElement = e.target;
        e.target.style.opacity = '0.5';
      });
      
      card.addEventListener('dragend', (e) => {
        e.target.style.opacity = '';
        draggedElement = null;
      });
      
      card.addEventListener('dragover', (e) => {
        e.preventDefault();
      });
      
      card.addEventListener('drop', (e) => {
        e.preventDefault();
        if (draggedElement && draggedElement !== e.target) {
          // 실제 재정렬 로직
          TripGen.showToast('일정 순서가 변경되었습니다.', 'info');
        }
      });
    });

    // 스테퍼 네비게이션 함수
    function navigateToStep(url) {
      window.location.href = url;
    }
    
    // 여행 상태에 따른 네비게이션 함수
    function navigateToTripStep(url) {
      // 현재 여행 상태 확인 (여행중: in-progress, 추억중: completed)
      const tripStatus = getTripStatus();
      
      if (tripStatus === 'completed') {
        // 추억중인 여행은 조회만 가능
        if (url.includes('06-생성된일정조회.html')) {
          window.location.href = url;
        } else {
          TripGen.showToast('완료된 여행은 조회만 가능합니다.', 'info');
        }
      } else {
        // 여행중이거나 계획중인 여행은 모든 화면 이동 가능
        window.location.href = url;
      }
    }
    
    // 여행 상태 확인 함수
    function getTripStatus() {
      // 실제로는 여행 데이터에서 상태를 가져와야 하지만, 
      // 현재는 유럽가족여행이 '여행중' 상태로 설정
      return 'in-progress'; // 'in-progress', 'completed', 'planning'
    }
  </script>
</body>
</html>