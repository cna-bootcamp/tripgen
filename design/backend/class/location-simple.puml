@startuml
!theme mono

title Location 서비스 간단 클래스 설계서 (Layered Architecture)

' ======================================
' Core Layers
' ======================================
package "Controller Layer" {
    class LocationController {
        +searchNearbyPlaces()
        +searchByKeyword()
        +getPlaceDetails()
        +getPlaceRecommendations()
        +getBusinessHours()
    }
}

package "Service Layer" {
    interface LocationService {
        +getPlaceDetails()
        +getPlaceRecommendations()
        +getBusinessHours()
    }
    
    interface LocationSearchService {
        +searchNearbyPlaces()
        +searchByKeyword()
    }
    
    class LocationServiceImpl {
        +getPlaceDetails()
        +getPlaceRecommendations()
        +getBusinessHours()
    }
    
    class LocationSearchServiceImpl {
        +searchNearbyPlaces()
        +searchByKeyword()
    }
    
    class ExternalApiService {
        +getPlaceDetailsFromExternal()
        +getBusinessHoursFromExternal()
    }
    
    class CacheService {
        +getPlaceDetails()
        +cachePlace()
        +getRecommendations()
    }
}

package "Repository Layer" {
    interface PlaceRepository {
        +findByPlaceId()
        +findNearbyPlaces()
        +searchByKeyword()
    }
    
    interface PlaceDetailRepository {
        +findByPlaceId()
        +save()
    }
    
    interface PlaceRecommendationRepository {
        +findByPlaceId()
        +save()
    }
}

package "External Clients" {
    interface AiServiceClient {
        +generatePlaceRecommendations()
        +isRecommendationReady()
    }
    
    interface GooglePlacesApiClient {
        +getPlaceDetails()
        +searchNearbyPlaces()
    }
    
    interface KakaoMapApiClient {
        +searchPlaces()
        +getDirections()
    }
}

' ======================================
' Core Domain Models
' ======================================
package "Domain Models" {
    class Place {
        -String placeId
        -String name
        -PlaceCategory category
        -Location location
        -Double rating
    }
    
    class PlaceDetail {
        -String placeId
        -List<String> images
        -ContactInfo contact
        -BusinessHours businessHours
    }
    
    class PlaceRecommendation {
        -String placeId
        -String recommendReason
        -AITips tips
        -LocalDateTime generatedAt
    }
    
    class Location {
        -Double latitude
        -Double longitude
        -String address
    }
    
    enum PlaceCategory {
        ALL, TOURIST, RESTAURANT, LAUNDRY
    }
}

' ======================================
' Key DTOs
' ======================================
package "DTOs" {
    class NearbySearchRequest {
        -Location origin
        -String transportMode
        -Integer timeRange
    }
    
    class PlaceDetails {
        -String placeId
        -String name
        -LocationInfo location
        -AIRecommendation aiRecommendation
    }
    
    class PlaceCard {
        -String placeId
        -String name
        -Double rating
        -Integer distance
    }
}

' ======================================
' Layer Dependencies (Layered Architecture)
' ======================================
LocationController --> LocationService : uses
LocationController --> LocationSearchService : uses

LocationService <|.. LocationServiceImpl : implements
LocationSearchService <|.. LocationSearchServiceImpl : implements

LocationServiceImpl --> PlaceRepository : uses
LocationServiceImpl --> PlaceDetailRepository : uses
LocationServiceImpl --> PlaceRecommendationRepository : uses
LocationServiceImpl --> ExternalApiService : uses
LocationServiceImpl --> CacheService : uses
LocationServiceImpl --> AiServiceClient : uses

LocationSearchServiceImpl --> PlaceRepository : uses
LocationSearchServiceImpl --> CacheService : uses

ExternalApiService --> GooglePlacesApiClient : uses
ExternalApiService --> KakaoMapApiClient : uses

' ======================================
' Domain Relationships
' ======================================
Place --> Location : contains
Place --> PlaceCategory : uses
PlaceDetail --> Place : belongs to
PlaceRecommendation --> Place : belongs to

' ======================================
' DTO Relationships
' ======================================
NearbySearchRequest --> Location : contains
PlaceDetails --> Place : converts from
PlaceCard --> Place : converts from

@enduml